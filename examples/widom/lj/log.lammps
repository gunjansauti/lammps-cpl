LAMMPS (27 Nov 2018)
# LJ simple fluid
# T = 2.0
# rho ~ 0.5
# p ~ 1.5
# comparable to Frenkel and Smit GCMC Case Study, Figure 5.8

# variables modifiable using -var command line switch

variable        temp index 2.0

# global model settings

units           lj
atom_style      bond
pair_style      lj/cut 3.0
pair_modify	tail no # turn of to avoid triggering full_energy
bond_style      harmonic

read_data	data.widom_lj
  orthogonal box = (0 0 0) to (5 5 5)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  64 atoms
  reading velocities ...
  64 velocities
  0 = max # of 1-2 neighbors
  0 = max # of 1-3 neighbors
  0 = max # of 1-4 neighbors
  1 = max # of special neighbors

# lj parameters

pair_coeff	* * 1.0 1.0
mass		* 1.0

# we recommend setting up a dedicated group for gcmc

group		widomgroup type 1
64 atoms in group widomgroup

# gcmc

fix             mywidom widomgroup widom 1 10000 1 29494 ${temp}
fix             mywidom widomgroup widom 1 10000 1 29494 2.0

#run
fix             1 all nvt temp ${temp} ${temp} 0.5
fix             1 all nvt temp 2.0 ${temp} 0.5
fix             1 all nvt temp 2.0 2.0 0.5


# output

thermo_style    custom step temp press pe ke density atoms f_mywidom[1] f_mywidom[2] f_mywidom[3]
thermo          10

run             1000
Neighbor list info ...
  update every 1 steps, delay 10 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.3
  ghost atom cutoff = 3.3
  binsize = 1.65, bins = 4 4 4
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d/newton
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 4.211 | 4.211 | 4.211 Mbytes
Step Temp Press PotEng KinEng Density Atoms f_mywidom[1] f_mywidom[2] f_mywidom[3] 
       0    2.0512651    1.5002534   -2.9075798    3.0288212        0.512       64          inf            0            0 
      10    2.2453486   0.78245111   -3.1959618    3.3153975        0.512       64   -5.8964598    132312.19          125 
      20    2.1687339   0.98581823   -3.0885428    3.2022711        0.512       64   -5.7299916    94843.475          125 
      30    2.1243778    1.1653408   -3.0354872    3.1367765        0.512       64   -5.6586217    82227.363          125 
      40    2.0325885     1.539263   -2.9160575    3.0012439        0.512       64   -5.5825719    70625.304          125 
      50    2.1643289    1.1088269   -3.1296612    3.1957668        0.512       64   -5.7008223    89468.743          125 
      60    1.9575757    1.7472287   -2.8452397    2.8904829        0.512       64   -5.7065149    90493.187          125 
      70    2.0192858    1.4725014   -2.9622531    2.9816018        0.512       64   -5.5742691    69462.208          125 
      80    2.0617824    1.2553576    -3.056153    3.0443506        0.512       64   -5.7960975     108249.6          125 
      90    2.0973761    1.0606626   -3.1414084    3.0969069        0.512       64   -5.6296895    77604.373          125 
     100    2.0240323    1.2148578    -3.070664    2.9886102        0.512       64   -5.7730176     103366.4          125 
     110    1.9206623    1.5744169   -2.9613999    2.8359779        0.512       64   -5.7964364       108323          125 
     120    1.9243057    1.5846042   -3.0101503    2.8413576        0.512       64   -5.6915478    87824.487          125 
     130    1.9073743     1.457725   -3.0287376    2.8163574        0.512       64   -5.6826931    86282.861          125 
     140    1.9290232    1.1354535    -3.112914    2.8483234        0.512       64   -6.2446006    265455.15          125 
     150    1.8915669   0.98538241   -3.1072281    2.7930168        0.512       64   -5.9143145    137122.38          125 
     160    1.7943229    1.1085331   -3.0135363      2.64943        0.512       64   -5.6974263    88863.122          125 
     170    1.7426221    1.1338381   -2.9929685    2.5730905        0.512       64   -5.7042471    90083.677          125 
     180    1.8242505   0.68497643   -3.1682551    2.6936199        0.512       64   -5.5030394    60239.214          125 
     190    1.8623554   0.34901998   -3.2802308    2.7498841        0.512       64   -5.4683935    56206.464          125 
     200    1.7481289   0.65226368   -3.1681979    2.5812215        0.512       64   -5.2171348    34005.232          125 
     210    1.6077776    1.0557067   -3.0143795    2.3739841        0.512       64   -5.3637579    45593.288          125 
     220    1.7267587   0.54532317   -3.2434208    2.5496672        0.512       64   -5.2875523    39148.002          125 
     230    1.7043918   0.51122618   -3.2545883     2.516641        0.512       64   -5.2632753    37292.612          125 
     240    1.6019007   0.76893277   -3.1429929    2.3653065        0.512       64   -5.3601446    45264.991          125 
     250    1.4997755    1.0528378   -3.0241275    2.2145123        0.512       64   -5.3927431    48314.463          125 
     260     1.503967   0.90233567   -3.0553444    2.2207013        0.512       64   -5.4807062    57607.754          125 
     270    1.6477649   0.32908477   -3.2846872    2.4330279        0.512       64   -5.4540467    54616.613          125 
     280    1.5687813   0.58020406   -3.1767549    2.3164037        0.512       64   -5.5758825    69686.723          125 
     290    1.5390473   0.81809451   -3.1327644    2.2724995        0.512       64   -5.4764072    57114.565          125 
     300    1.4184543    1.4146549   -2.9444162    2.0944364        0.512       64   -5.5449493    65506.108          125 
     310    1.5175144    1.2246638   -3.0665243    2.2407049        0.512       64   -5.4564731    54882.297          125 
     320    1.6863739   0.61909244   -3.2721124    2.4900365        0.512       64   -5.5324371    63887.192          125 
     330    1.6808487   0.69569573   -3.1999641    2.4818781        0.512       64   -5.5655488     68261.26          125 
     340    1.6456563   0.95462051   -3.0709421    2.4299144        0.512       64   -5.6373995    78810.302          125 
     350    1.9199087   0.29990381   -3.3756018    2.8348652        0.512       64   -5.5399365    64852.645          125 
     360     1.844892    1.0979633   -3.1470752    2.7240984        0.512       64   -5.0831734    26012.873          125 
     370    1.8677206    1.6000261   -3.0714636    2.7578062        0.512       64   -5.2197367    34182.645          125 
     380    1.9190105    1.8222249    -3.041885    2.8335389        0.512       64   -5.6297181    77608.803          125 
     390    1.9473834    1.8664799    -2.988413    2.8754333        0.512       64   -5.6344285    78343.397          125 
     400    2.0695467     1.467362   -3.0867911    3.0558151        0.512       64   -5.4105346    50064.583          125 
     410    2.0928273    1.4812233   -3.0527149    3.0901904        0.512       64   -5.5986511    72933.414          125 
     420    1.9597126    1.9773447   -2.8062472    2.8936381        0.512       64   -5.4255083     51586.57          125 
     430    2.1045831    1.5018713   -2.9752319    3.1075485        0.512       64   -5.3284864    42487.821          125 
     440    2.1764101    1.2396454   -3.0453134    3.2136055        0.512       64    -5.773981    103565.75          125 
     450    2.1917485    1.3407438   -3.0434712    3.2362537        0.512       64   -5.7967144    108383.24          125 
     460    1.8997043    2.4029111   -2.5931524    2.8050321        0.512       64   -5.9098667       135908          125 
     470    2.1446164    1.4098179   -2.9391566    3.1666601        0.512       64   -5.7585511    100418.54          125 
     480    2.2772976   0.89240671   -3.1258533    3.3625723        0.512       64   -5.7658244    101889.96          125 
     490    2.1215901    1.3980032   -2.8932371    3.1326604        0.512       64   -5.5513969    66356.291          125 
     500    2.2717978    1.0114158   -3.1222043    3.3544514        0.512       64   -5.7562616    99959.772          125 
     510    2.1176208    1.7169583   -2.9041113    3.1267994        0.512       64   -5.8749792    126748.27          125 
     520    2.2295469    1.3996214     -3.08796    3.2920654        0.512       64   -5.6880436    87211.126          125 
     530    1.9707771    2.2369544   -2.7278848    2.9099755        0.512       64   -5.8586441     122674.3          125 
     540     2.196645    1.3045916   -3.0858555    3.2434836        0.512       64   -6.1026952    199863.59          125 
     550    2.2254214    1.0213565   -3.1574269    3.2859737        0.512       64   -5.9580196     149647.7          125 
     560    1.9802753    1.7981482   -2.8305841    2.9240002        0.512       64   -5.8860852    129595.12          125 
     570    2.1147991    1.2833289    -3.067279     3.122633        0.512       64   -5.5421189    65136.328          125 
     580    2.1048904    1.3298306   -3.0971999    3.1080023        0.512       64   -5.3074671    40738.721          125 
     590    1.9970831    1.6943099    -2.981969    2.9488179        0.512       64   -5.7976169    108579.05          125 
     600    2.0288194      1.44025   -3.0744108    2.9956786        0.512       64   -5.9667203    152274.58          125 
     610    1.9693456    1.4988221   -3.0331984    2.9078619        0.512       64   -5.3083224    40808.468          125 
     620    2.0031304    1.3235744   -3.1304832    2.9577472        0.512       64    -5.735371    95869.394          125 
     630    1.6867919    2.1777144    -2.703564    2.4906537        0.512       64   -5.4012149    49140.054          125 
     640     1.881054    1.2447352   -3.0288711    2.7774938        0.512       64   -5.2750255    38179.386          125 
     650    1.9989241   0.60253608   -3.2384474    2.9515363        0.512       64   -5.2521096     36469.05          125 
     660    1.7736982    1.3151677     -2.93965    2.6189762        0.512       64   -5.1883349    32101.876          125 
     670    1.7395055    1.4482761   -2.9181632    2.5684887        0.512       64   -4.9202827    18780.333          125 
     680    1.8772006    1.0209268   -3.1459536     2.771804        0.512       64   -5.1297078    28550.094          125 
     690    1.8003528    1.2888091   -3.0496522    2.6583334        0.512       64   -5.0360873    23674.994          125 
     700    1.8930692   0.93859442   -3.2016841     2.795235        0.512       64   -5.1113713    27522.044          125 
     710    1.9778547   0.65021398   -3.3416471    2.9204261        0.512       64   -5.2055516    33226.507          125 
     720    1.8082639    1.2470212   -3.1049985    2.6700147        0.512       64   -5.2574609    36861.461          125 
     730    1.8028291    1.3215291   -3.1058851    2.6619898        0.512       64   -5.8698585    125456.83          125 
     740     1.689151    1.6766587   -2.9404054    2.4941371        0.512       64   -5.5191969    62217.637          125 
     750    1.8460652    1.0062142   -3.1711787    2.7258306        0.512       64   -5.7385089    96472.942          125 
     760    1.8887666   0.65055189   -3.2277002     2.788882        0.512       64   -5.4543289    54647.443          125 
     770    1.9340303   0.37488342   -3.2790511    2.8557166        0.512       64   -5.3520871    44541.397          125 
     780    1.8707624   0.66810273   -3.1687514    2.7622976        0.512       64   -5.4548559    54705.076          125 
     790    1.8393146   0.84776956   -3.0992727    2.7158629        0.512       64   -5.4975537    59581.911          125 
     800    1.8944131   0.78713382   -3.1453991    2.7972194        0.512       64   -5.1993243    32815.251          125 
     810    1.8715997      1.05044   -3.0677966    2.7635339        0.512       64   -5.2957647    39796.308          125 
     820    1.9682188   0.87089579   -3.1510303    2.9061981        0.512       64   -5.9229117     139500.5          125 
     830    2.0231716    1.0077777   -3.1600027    2.9873393        0.512       64   -5.8877796    130035.04          125 
     840    1.8708818    1.8630694   -2.8560326    2.7624739        0.512       64   -6.0337375    174115.63          125 
     850    2.0852559    1.3262738   -3.0817739    3.0790107        0.512       64   -5.8693455    125328.18          125 
     860     2.136361    1.4856416   -3.0569792    3.1544706        0.512       64   -5.8943248    131748.43          125 
     870    2.0480065    2.1488465   -2.8328012    3.0240096        0.512       64   -5.7739084    103550.72          125 
     880    2.1483442    1.9265744   -2.8925061    3.1721645        0.512       64   -5.6879699    87198.279          125 
     890    2.2528522    1.5499844   -2.9531963     3.326477        0.512       64   -5.7663913    102005.57          125 
     900    2.2382855    1.7418732   -2.8566116    3.3049684        0.512       64   -5.4740632    56847.431          125 
     910    2.4442988    1.2182805   -3.0989461    3.6091599        0.512       64   -5.4218819    51213.776          125 
     920    2.2284356    1.9153613   -2.7312896    3.2904245        0.512       64   -5.5696525    68823.809          125 
     930    2.3661276    1.3968737    -2.906817    3.4937353        0.512       64     -5.53517    64237.342          125 
     940    2.4599806    1.0156238   -3.0265253    3.6323151        0.512       64   -5.3012265    40233.407          125 
     950    2.4853105    0.9858935   -3.0641785    3.6697162        0.512       64   -5.1522558    29867.061          125 
     960    2.2702069    1.8523991   -2.7584073    3.3521024        0.512       64   -5.4782909    57330.137          125 
     970    2.4416889    1.2088246   -3.0364811    3.6053062        0.512       64   -5.4556426    54791.217          125 
     980    2.4554584     1.078941   -3.0965813    3.6256377        0.512       64   -5.5503856    66222.216          125 
     990    2.4629365    1.0251308   -3.1603566    3.6366797        0.512       64   -5.6362134    78623.568          125 
    1000    2.2671902    1.7164382   -2.9358481    3.3476481        0.512       64   -5.6418506    79515.011          125 
Loop time of 90.2574 on 1 procs for 1000 steps with 64 atoms

Performance: 4786.310 tau/day, 11.079 timesteps/s
100.0% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.10175    | 0.10175    | 0.10175    |   0.0 |  0.11
Bond    | 0.000175   | 0.000175   | 0.000175   |   0.0 |  0.00
Neigh   | 0.20507    | 0.20507    | 0.20507    |   0.0 |  0.23
Comm    | 0.072597   | 0.072597   | 0.072597   |   0.0 |  0.08
Output  | 0.0017741  | 0.0017741  | 0.0017741  |   0.0 |  0.00
Modify  | 89.874     | 89.874     | 89.874     |   0.0 | 99.57
Other   |            | 0.002384   |            |       |  0.00

Nlocal:    64 ave 64 max 64 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    727 ave 727 max 727 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    2426 ave 2426 max 2426 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 2426
Ave neighs/atom = 37.9062
Ave special neighs/atom = 0
Neighbor list builds = 1000
Dangerous builds = 0
Total wall time: 0:01:30
